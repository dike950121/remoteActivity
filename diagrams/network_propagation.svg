<svg width="1500" height="1100" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; fill: #2c3e50; }
      .subtitle { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; fill: #34495e; }
      .text { font-family: Arial, sans-serif; font-size: 12px; fill: #2c3e50; }
      .small-text { font-family: Arial, sans-serif; font-size: 10px; fill: #7f8c8d; }
      .recon-box { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .exploit-box { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; }
      .credential-box { fill: #f39c12; stroke: #e67e22; stroke-width: 2; }
      .lateral-box { fill: #9b59b6; stroke: #8e44ad; stroke-width: 2; }
      .ad-box { fill: #2ecc71; stroke: #27ae60; stroke-width: 2; }
      .decision-diamond { fill: #95a5a6; stroke: #7f8c8d; stroke-width: 2; }
      .arrow { stroke: #34495e; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .success-arrow { stroke: #27ae60; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .fail-arrow { stroke: #e74c3c; stroke-width: 2; fill: none; marker-end: url(#arrowhead); stroke-dasharray: 5,5; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#34495e" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="750" y="30" text-anchor="middle" class="title">Network Propagation &amp; Lateral Movement Flow</text>
  
  <!-- Initial Compromise -->
  <rect x="650" y="60" width="200" height="50" rx="5" class="recon-box"/>
  <text x="750" y="80" text-anchor="middle" class="text">Initial System Compromise</text>
  <text x="750" y="95" text-anchor="middle" class="small-text">Payload successfully installed</text>
  
  <!-- Phase 1: Network Reconnaissance -->
  <rect x="50" y="140" width="1400" height="160" rx="10" class="recon-box" opacity="0.1"/>
  <text x="750" y="165" text-anchor="middle" class="subtitle">PHASE 1: NETWORK RECONNAISSANCE &amp; DISCOVERY</text>
  
  <!-- Network Scanning -->
  <rect x="80" y="180" width="180" height="80" rx="5" class="recon-box"/>
  <text x="170" y="205" text-anchor="middle" class="text">Network Scanning</text>
  <text x="90" y="220" class="small-text">• ARP table enumeration</text>
  <text x="90" y="235" class="small-text">• ICMP ping sweeps</text>
  <text x="90" y="250" class="small-text">• Port scanning (TCP/UDP)</text>
  
  <rect x="280" y="180" width="180" height="80" rx="5" class="recon-box"/>
  <text x="370" y="205" text-anchor="middle" class="text">Service Discovery</text>
  <text x="290" y="220" class="small-text">• SMB share enumeration</text>
  <text x="290" y="235" class="small-text">• RDP service detection</text>
  <text x="290" y="250" class="small-text">• SSH/Telnet identification</text>
  
  <rect x="480" y="180" width="180" height="80" rx="5" class="recon-box"/>
  <text x="570" y="205" text-anchor="middle" class="text">Domain Discovery</text>
  <text x="490" y="220" class="small-text">• Domain controller location</text>
  <text x="490" y="235" class="small-text">• LDAP enumeration</text>
  <text x="490" y="250" class="small-text">• DNS zone transfers</text>
  
  <rect x="680" y="180" width="180" height="80" rx="5" class="recon-box"/>
  <text x="770" y="205" text-anchor="middle" class="text">User Enumeration</text>
  <text x="690" y="220" class="small-text">• Local user accounts</text>
  <text x="690" y="235" class="small-text">• Domain user discovery</text>
  <text x="690" y="250" class="small-text">• Group membership</text>
  
  <rect x="880" y="180" width="180" height="80" rx="5" class="recon-box"/>
  <text x="970" y="205" text-anchor="middle" class="text">System Profiling</text>
  <text x="890" y="220" class="small-text">• OS version detection</text>
  <text x="890" y="235" class="small-text">• Installed software</text>
  <text x="890" y="250" class="small-text">• Security products</text>
  
  <rect x="1080" y="180" width="180" height="80" rx="5" class="recon-box"/>
  <text x="1170" y="205" text-anchor="middle" class="text">Network Topology</text>
  <text x="1090" y="220" class="small-text">• Routing table analysis</text>
  <text x="1090" y="235" class="small-text">• VLAN identification</text>
  <text x="1090" y="250" class="small-text">• Trust relationships</text>
  
  <rect x="1280" y="180" width="180" height="80" rx="5" class="recon-box"/>
  <text x="1370" y="205" text-anchor="middle" class="text">Vulnerability Scan</text>
  <text x="1290" y="220" class="small-text">• Known CVE detection</text>
  <text x="1290" y="235" class="small-text">• Weak configurations</text>
  <text x="1290" y="250" class="small-text">• Default credentials</text>
  
  <!-- Phase 2: Credential Harvesting -->
  <rect x="50" y="320" width="1400" height="160" rx="10" class="credential-box" opacity="0.1"/>
  <text x="750" y="345" text-anchor="middle" class="subtitle">PHASE 2: CREDENTIAL HARVESTING &amp; COLLECTION</text>
  
  <!-- Local Credential Extraction -->
  <rect x="80" y="360" width="200" height="80" rx="5" class="credential-box"/>
  <text x="180" y="385" text-anchor="middle" class="text">Local Credentials</text>
  <text x="90" y="400" class="small-text">• LSASS memory dumping</text>
  <text x="90" y="415" class="small-text">• SAM database extraction</text>
  <text x="90" y="430" class="small-text">• Cached domain credentials</text>
  
  <rect x="300" y="360" width="200" height="80" rx="5" class="credential-box"/>
  <text x="400" y="385" text-anchor="middle" class="text">Browser Credentials</text>
  <text x="310" y="400" class="small-text">• Saved passwords</text>
  <text x="310" y="415" class="small-text">• Session cookies</text>
  <text x="310" y="430" class="small-text">• Auto-fill data</text>
  
  <rect x="520" y="360" width="200" height="80" rx="5" class="credential-box"/>
  <text x="620" y="385" text-anchor="middle" class="text">Application Secrets</text>
  <text x="530" y="400" class="small-text">• Configuration files</text>
  <text x="530" y="415" class="small-text">• Database connections</text>
  <text x="530" y="430" class="small-text">• API keys &amp; tokens</text>
  
  <rect x="740" y="360" width="200" height="80" rx="5" class="credential-box"/>
  <text x="840" y="385" text-anchor="middle" class="text">Network Credentials</text>
  <text x="750" y="400" class="small-text">• WiFi passwords</text>
  <text x="750" y="415" class="small-text">• VPN configurations</text>
  <text x="750" y="430" class="small-text">• Network shares</text>
  
  <rect x="960" y="360" width="200" height="80" rx="5" class="credential-box"/>
  <text x="1060" y="385" text-anchor="middle" class="text">Kerberos Tickets</text>
  <text x="970" y="400" class="small-text">• TGT extraction</text>
  <text x="970" y="415" class="small-text">• Service tickets</text>
  <text x="970" y="430" class="small-text">• Golden/Silver tickets</text>
  
  <rect x="1180" y="360" width="200" height="80" rx="5" class="credential-box"/>
  <text x="1280" y="385" text-anchor="middle" class="text">Hash Collection</text>
  <text x="1190" y="400" class="small-text">• NTLM hashes</text>
  <text x="1190" y="415" class="small-text">• LM hashes</text>
  <text x="1190" y="430" class="small-text">• Kerberos hashes</text>
  
  <!-- Phase 3: Lateral Movement Techniques -->
  <rect x="50" y="500" width="1400" height="200" rx="10" class="lateral-box" opacity="0.1"/>
  <text x="750" y="525" text-anchor="middle" class="subtitle">PHASE 3: LATERAL MOVEMENT TECHNIQUES</text>
  
  <!-- SMB-based Movement -->
  <rect x="80" y="540" width="180" height="80" rx="5" class="lateral-box"/>
  <text x="170" y="565" text-anchor="middle" class="text">SMB Exploitation</text>
  <text x="90" y="580" class="small-text">• Pass-the-hash attacks</text>
  <text x="90" y="595" class="small-text">• SMB relay attacks</text>
  <text x="90" y="610" class="small-text">• EternalBlue (MS17-010)</text>
  
  <rect x="280" y="540" width="180" height="80" rx="5" class="lateral-box"/>
  <text x="370" y="565" text-anchor="middle" class="text">RDP Compromise</text>
  <text x="290" y="580" class="small-text">• Credential stuffing</text>
  <text x="290" y="595" class="small-text">• RDP vulnerabilities</text>
  <text x="290" y="610" class="small-text">• Session hijacking</text>
  
  <rect x="480" y="540" width="180" height="80" rx="5" class="lateral-box"/>
  <text x="570" y="565" text-anchor="middle" class="text">WMI Execution</text>
  <text x="490" y="580" class="small-text">• Remote WMI calls</text>
  <text x="490" y="595" class="small-text">• WMI event subscriptions</text>
  <text x="490" y="610" class="small-text">• PowerShell remoting</text>
  
  <rect x="680" y="540" width="180" height="80" rx="5" class="lateral-box"/>
  <text x="770" y="565" text-anchor="middle" class="text">Service Exploitation</text>
  <text x="690" y="580" class="small-text">• Service account abuse</text>
  <text x="690" y="595" class="small-text">• Scheduled task creation</text>
  <text x="690" y="610" class="small-text">• Service installation</text>
  
  <rect x="880" y="540" width="180" height="80" rx="5" class="lateral-box"/>
  <text x="970" y="565" text-anchor="middle" class="text">SSH/Remote Shell</text>
  <text x="890" y="580" class="small-text">• SSH key abuse</text>
  <text x="890" y="595" class="small-text">• Weak SSH configs</text>
  <text x="890" y="610" class="small-text">• Remote shell injection</text>
  
  <rect x="1080" y="540" width="180" height="80" rx="5" class="lateral-box"/>
  <text x="1170" y="565" text-anchor="middle" class="text">Application Exploits</text>
  <text x="1090" y="580" class="small-text">• Web application flaws</text>
  <text x="1090" y="595" class="small-text">• Database exploits</text>
  <text x="1090" y="610" class="small-text">• Service vulnerabilities</text>
  
  <rect x="1280" y="540" width="180" height="80" rx="5" class="lateral-box"/>
  <text x="1370" y="565" text-anchor="middle" class="text">Supply Chain</text>
  <text x="1290" y="580" class="small-text">• Software updates</text>
  <text x="1290" y="595" class="small-text">• Trusted installers</text>
  <text x="1290" y="610" class="small-text">• Signed binaries</text>
  
  <!-- Decision Point -->
  <polygon points="750,650 800,680 750,710 700,680" class="decision-diamond"/>
  <text x="750" y="685" text-anchor="middle" class="text">Target in AD?</text>
  
  <!-- Phase 4: Active Directory Targeting -->
  <rect x="50" y="740" width="1400" height="200" rx="10" class="ad-box" opacity="0.1"/>
  <text x="750" y="765" text-anchor="middle" class="subtitle">PHASE 4: ACTIVE DIRECTORY TARGETING &amp; DOMAIN COMPROMISE</text>
  
  <!-- AD Reconnaissance -->
  <rect x="80" y="780" width="180" height="80" rx="5" class="ad-box"/>
  <text x="170" y="805" text-anchor="middle" class="text">AD Enumeration</text>
  <text x="90" y="820" class="small-text">• Domain controller discovery</text>
  <text x="90" y="835" class="small-text">• Trust relationship mapping</text>
  <text x="90" y="850" class="small-text">• Privilege escalation paths</text>
  
  <rect x="280" y="780" width="180" height="80" rx="5" class="ad-box"/>
  <text x="370" y="805" text-anchor="middle" class="text">Kerberos Attacks</text>
  <text x="290" y="820" class="small-text">• Kerberoasting</text>
  <text x="290" y="835" class="small-text">• ASREPRoasting</text>
  <text x="290" y="850" class="small-text">• Golden ticket attacks</text>
  
  <rect x="480" y="780" width="180" height="80" rx="5" class="ad-box"/>
  <text x="570" y="805" text-anchor="middle" class="text">DCSync Attacks</text>
  <text x="490" y="820" class="small-text">• Domain controller sync</text>
  <text x="490" y="835" class="small-text">• Password hash extraction</text>
  <text x="490" y="850" class="small-text">• KRBTGT compromise</text>
  
  <rect x="680" y="780" width="180" height="80" rx="5" class="ad-box"/>
  <text x="770" y="805" text-anchor="middle" class="text">GPO Manipulation</text>
  <text x="690" y="820" class="small-text">• Group Policy abuse</text>
  <text x="690" y="835" class="small-text">• Startup script injection</text>
  <text x="690" y="850" class="small-text">• Scheduled task GPOs</text>
  
  <rect x="880" y="780" width="180" height="80" rx="5" class="ad-box"/>
  <text x="970" y="805" text-anchor="middle" class="text">Forest Compromise</text>
  <text x="890" y="820" class="small-text">• Cross-domain attacks</text>
  <text x="890" y="835" class="small-text">• Forest trust abuse</text>
  <text x="890" y="850" class="small-text">• Enterprise admin access</text>
  
  <rect x="1080" y="780" width="180" height="80" rx="5" class="ad-box"/>
  <text x="1170" y="805" text-anchor="middle" class="text">Persistence in AD</text>
  <text x="1090" y="820" class="small-text">• AdminSDHolder abuse</text>
  <text x="1090" y="835" class="small-text">• DSRM password</text>
  <text x="1090" y="850" class="small-text">• Skeleton key malware</text>
  
  <rect x="1280" y="780" width="180" height="80" rx="5" class="ad-box"/>
  <text x="1370" y="805" text-anchor="middle" class="text">Data Exfiltration</text>
  <text x="1290" y="820" class="small-text">• SYSVOL access</text>
  <text x="1290" y="835" class="small-text">• NTDS.dit extraction</text>
  <text x="1290" y="850" class="small-text">• Sensitive file access</text>
  
  <!-- Success/Failure Paths -->
  <rect x="200" y="960" width="300" height="60" rx="5" class="exploit-box"/>
  <text x="350" y="985" text-anchor="middle" class="text">Payload Deployment Successful</text>
  <text x="210" y="1005" class="small-text">• Install payload on compromised system</text>
  <text x="210" y="1015" class="small-text">• Establish C2 communication</text>
  
  <rect x="600" y="960" width="300" height="60" rx="5" class="lateral-box"/>
  <text x="750" y="985" text-anchor="middle" class="text">Continue Lateral Movement</text>
  <text x="610" y="1005" class="small-text">• Repeat process on new targets</text>
  <text x="610" y="1015" class="small-text">• Expand network footprint</text>
  
  <rect x="1000" y="960" width="300" height="60" rx="5" class="credential-box"/>
  <text x="1150" y="985" text-anchor="middle" class="text">Escalate Privileges</text>
  <text x="1010" y="1005" class="small-text">• Attempt privilege escalation</text>
  <text x="1010" y="1015" class="small-text">• Target high-value accounts</text>
  
  <!-- Flow Arrows -->
  <line x1="750" y1="110" x2="750" y2="140" class="arrow"/>
  <line x1="750" y1="300" x2="750" y2="320" class="arrow"/>
  <line x1="750" y1="480" x2="750" y2="500" class="arrow"/>
  <line x1="750" y1="700" x2="750" y2="650" class="arrow"/>
  
  <!-- Decision branches -->
  <line x1="700" y1="680" x2="350" y2="960" class="success-arrow"/>
  <line x1="750" y1="710" x2="750" y2="740" class="success-arrow"/>
  <line x1="800" y1="680" x2="1150" y2="960" class="success-arrow"/>
  
  <!-- Lateral movement loop -->
  <line x1="750" y1="940" x2="750" y2="960" class="arrow"/>
  <line x1="900" y1="990" x2="1300" y2="990" class="arrow"/>
  <line x1="1300" y1="990" x2="1300" y2="300" class="arrow"/>
  <line x1="1300" y1="300" x2="750" y2="300" class="arrow"/>
  
  <!-- Labels -->
  <text x="525" y="675" class="small-text">NO</text>
  <text x="750" y="730" class="small-text">YES</text>
  <text x="975" y="675" class="small-text">ESCALATE</text>
  
  <!-- Legend -->
  <rect x="50" y="1050" width="800" height="40" rx="3" fill="#ecf0f1" stroke="#bdc3c7"/>
  <text x="60" y="1070" class="small-text">Legend: Green arrows = Success path | Red dashed = Failure/retry | Blue = Normal flow</text>
  <text x="60" y="1085" class="small-text">Process repeats until maximum network penetration achieved or detection occurs</text>
</svg>